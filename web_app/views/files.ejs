<%
const body = `
<h1>ğŸ“ File System</h1>

<div class="warning">
    <strong>Challenge 3: Directory Traversal</strong><br>
    Can you access files outside the intended directory?
</div>

<div style="margin: 30px 0;">
    <h2>Available Files:</h2>
    <ul style="list-style: none; padding: 0;">
        ${files.map(file => `
            <li style="margin: 10px 0;">
                <a href="/view-file?file=${file}"
                   style="display: block; padding: 15px; background: #f8f9fa; border: 2px solid #ddd; border-radius: 5px; text-decoration: none; color: #333; transition: all 0.3s;"
                   onmouseover="this.style.borderColor='#667eea'; this.style.background='#e7f3ff'"
                   onmouseout="this.style.borderColor='#ddd'; this.style.background='#f8f9fa'">
                    ğŸ“„ ${file}
                </a>
            </li>
        `).join('')}
    </ul>
</div>

<div style="padding: 20px; background: #fff3cd; border-radius: 5px; margin: 30px 0;">
    <h3>ğŸ’¡ Directory Traversal Hints:</h3>
    <ul style="margin-left: 20px; line-height: 1.8;">
        <li>The file parameter in the URL is not properly validated</li>
        <li>Try: <code>../secret.txt</code> to go up one directory</li>
        <li>Try: <code>../../web_app/data/secret.txt</code> for deeper traversal</li>
        <li>Goal: Find and read the secret.txt file!</li>
    </ul>
</div>

<div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 30px 0;">
    <h3>Try it yourself:</h3>
    <form method="GET" action="/view-file" style="display: flex; gap: 10px;">
        <input type="text" name="file" placeholder="Enter filename..."
               style="flex: 1; padding: 10px; border: 2px solid #ddd; border-radius: 5px; font-size: 1em;">
        <button type="submit"
                style="padding: 10px 30px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 1em;">
            View File
        </button>
    </form>
</div>
`;
%>
<%- include('layout', { body, user }) %>
